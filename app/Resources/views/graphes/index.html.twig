{% extends 'baseAdmin.html.twig' %}
{% block body %}
    <style>
        body{
            background: white;
        }
        .aa{
            padding: 1.5rem;
            margin-right: 0;
            margin-bottom: 0;
            margin-left: 0;
            border: solid 1px #dddddd;

        }
        #1 option[label]{
            float: left;
            color: red;
        }
        .panel-success>.panel-heading{
            background: linear-gradient(to bottom, #fff 0%, #f6f6f6 19%, #ededed 100%);
            border-color: #dddddd;
            color: #000;
        }
        .panel-success {
            border-color: #dddddd;

        }
        .panel-title{
            font-size: 12px;
        }
        .forms{
            margin-bottom: 10px;
        }

        .fa-close{
            -webkit-border-radius: 100px;
            font-size: 1.1em;
            color: white;
            border-radius: 100px;
            line-height: 0.9em;
            padding: 5px 6px;
            margin-top: 20px;
            cursor: pointer;
            background: linear-gradient(to bottom, #f85032 0%, #f16f5c 19%, #f6290c 55%, #f02f17 71%, #e73827 100%);
        }
        .del{
            position: relative;
            float: right;
            margin-top: -48px;
            margin-right: -27px;

        }
        form .row{
            margin-bottom: 0;
        }
        .main-spinner {

            height: 6px;
            left: -10px;
            margin: 0;
            position: fixed;
            right: -3px;
            width: 103%;
            z-index: 99;
            top: 38px;
            max-width: 103%;
        }
        .progress {
            overflow: hidden;
            height: 18px;
            margin-bottom: 20px;
            background-color: #f5f5f5;
            border-radius: 4px;
            -webkit-box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
        }
        .progress-bar {
            float: left;
            width: 0%;
            height: 100%;
            font-size: 12px;
            color: #ffffff;
            text-align: center;
            background-color: #428bca;
            -webkit-box-shadow: inset 0 -1px 0 rgba(0,0,0,0.15);
            box-shadow: inset 0 -1px 0 rgba(0,0,0,0.15);
            -webkit-transition: width 0.6s ease;
            transition: width 0.6s ease;
        }
        .progress-striped .progress-bar {
            background-image: linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);
            background-size: 40px 40px;
        }
        .progress.active .progress-bar, .progress-bar.active {
            -webkit-animation: progress-bar-stripes 2s linear infinite;
            -o-animation: progress-bar-stripes 2s linear infinite;
            animation: progress-bar-stripes 0.2s linear infinite;
        }
        textarea.acheteur {
            height: 32px;
        }

    </style>
    <div class="container  wide-content" style="width: 100%;">

        <div id="pad-wrapper">


            <div class="well hidden-print" id="reports_menu">
                {{ form_start(form) }}
                <form id="form1" action="/reports/charts" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="✓">


                    <div class="row">


                        <div class="col-sm-6">

                            {{ form_label(form.typeRapport, "Type de rapport ") }}
                            {{ form_widget(form.typeRapport,{'attr': {'class': 'form-control'}}) }}
                            {{ form_errors(form.typeRapport) }}

                        </div>


                        <div class="">



                            <div class="col-sm-2">
                                {{ form_label(form.du, "Date du") }}
                                {{ form_widget(form.du,{'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.du) }}

                            </div>

                            <div class="col-sm-2">
                                {{ form_label(form.au, "Date au") }}
                                {{ form_widget(form.au,{'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.au) }}

                            </div>

                        </div>

                        <div class="col-sm-2">

                            {{ form_label(form.grouperPar, "Grouper par") }}
                            {{ form_widget(form.grouperPar,{'attr': {'class': 'form-control'}}) }}
                            {{ form_errors(form.grouperPar) }}

                        </div>

                        <div class="col-sm-2">
                            {{ form_label(form.zonnestocks, "Entrepôts") }}
                            {{ form_widget(form.zonnestocks,{'attr': {'class': 'form-control'}}) }}
                            {{ form_errors(form.zonnestocks) }}

                        </div>

                        <div class="col-sm-2" style="padding-bottom:10px;">
                            {{ form_label(form.additionnelle, "Rechercher par date") }}
                            {{ form_widget(form.additionnelle,{'attr': {'class': 'form-control'}}) }}
                            {{ form_errors(form.additionnelle) }}

                        </div>


                    </div> <!-- row -->

                    <div class="clear"></div>

                    <input type="hidden" name="more" id="more" value="yes" disabled>

                    <div id="more11" style="">

                        <div class="row">

                            <div class="col-sm-2">
                                {{ form_label(form.montants, "Montants (HT, TTC, ou TVA)") }}
                                {{ form_widget(form.montants,{'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.montants) }}

                            </div>


                            <div class="col-sm-2">
                                {{ form_label(form.typeDocument, "Type de document") }}
                                {{ form_widget(form.typeDocument,{'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.typeDocument) }}

                            </div>

                            <div class="col-sm-2">
                                {{ form_label(form.etat, "Etat") }}
                                {{ form_widget(form.etat,{'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.etat) }}

                            </div>


                            <div class="col-sm-2">
                                {{ form_label(form.contact, "Contact") }}
                                {{ form_widget(form.contact,{'attr': {'class': 'form-control','autocomplete': 'off'}}) }}
                                {{ form_errors(form.contact) }}
                                <div id="acheteur" style="position: absolute;z-index: 999;margin-top: 10px;margin-left: -4px;width: 100%;"></div>
                                <a style="top: 30px;" class="autocomplete_vendeur" >▼</a>
                            </div>

                        </div>



                    </div> <!--more -->


                    <div class="report-menu-buttons buttons">
                        <a class="report-menu-button-more" href="#" onclick="$(&#39;#more11&#39;).fadeToggle(); $(this).text($(&#39;#more&#39;).prop(&#39;disabled&#39;) ? &quot;Moins d&#39;options&quot; : &quot;Plus d&#39;options&quot;); $(&#39;#more&#39;).prop(&#39;disabled&#39;, !$(&#39;#more&#39;).prop(&#39;disabled&#39;)); return false;">Plus d&#39;options</a>
                        <br><br>
                        <input type="submit" name="commit" value="Afficher le rapport" class="btn-glow primary" onclick="$('#pdf').val('no'); remove_xls();">

                        <input type="submit" name="commit" value="Exporter vers XLS" class="btn-glow" onclick="to_xls(); return false">


                        <a class="btn-glow" href="#" onclick="window.print(); return false;"><i class="icon-print"></i>&nbsp;&nbsp;Imprimer</a>


                    </div><span class="buttons_indicator" style="display:none;"><img alt="loading...." src="/assets/img/ajax-loader-wide.gif"></span>

                    <div class="clear"></div>

                </form>



                {{ form_end(form) }}

            </div> <!-- well -->

            <!-- <h2>Rapports</h2>
             -->
            <script type="text/javascript" src="{{ asset('https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js') }}"></script>


            <script type="text/javascript">

                $('#more11').hide();
                $(function () {

                    $('#category_ids').select2({
                        placeholder: 'Choisir...'
                    })

                    $('#department_ids').select2({
                        placeholder: 'Choisir...'
                    });

                    if(window.location.href.indexOf("kpir") > -1) {
                        $('#form1').addClass('no_sending_loader')
                    }

                });


            </script>


            <script src="{{ asset('js/jquery.js') }}" type="text/javascript"></script>

            <script src="{{ asset('js/highcharts.js') }}"></script>
            <script src="{{ asset('js/exporting.js') }}"></script>

            <script type="text/javascript">
                {{ chart(chart) }}
            </script>




            <div id="report_chart">


                <div id="linechart" style="width:678px; min-width: 400px; height: 400px; margin: 0 auto">

                </div>
                <div class="clear"></div>
                <div id="table1" style="" class="in_charts">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>mois</th>
                            <th class="number">Revenus</th>
                            <th class="number">Dépenses</th>
                            <th class="number">Total</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for facture in factures %}

                            {% for depense in depenses %}
                                <tr>

                                    <td>{{ facture.datecreation|date("Y-m") }}</td>





                                    <td class="number">{{ facture.total }}</td>
                                    <td class="number">{{ depense.total }} </td>

                                    <td class="number">{{ facture.total - depense.total }}</td>
                                </tr>
                            {% endfor %}
                        {% endfor %}
                        <tr>
                            <th class="number">TOTAL</th>
                            <th class="number"></th>
                            <th class="number"> </th>
                            <th class="number"> </th>
                        </tr>


                        </tbody>
                    </table>
                </div>
            </div>


        </div><!-- pad-wrapper -->

    </div>

    <script>
        var loader = "{{ asset('image/ajax-loader-wide.gif') }}"; //link to the animated loader-small.gif
        var ROOT_URL2 = "{{ url('admin_depenses_getAcheteur')}}";
        $('#indicator1').hide();
        $('.autocomplete_vendeur').hover(

            function () {
                $('.autocomplete_vendeur').css( "color", "#000" );
            }, function () {
                $('.autocomplete_vendeur').css( "color", "#ddd" );

            });
        $('#Graphes_contact').hover(

            function () {
                $('.autocomplete_vendeur').css( "color", "#000" );
            }, function () {
                $('.autocomplete_vendeur').css( "color", "#ddd" );

            });
        $( 'a.autocomplete_vendeur' ).click(function() {

            var input = $(this).val(); // We take the input value

            $('#indicator1').show();// Loader icon apprears in the <div id="match"></div>
            var data = {input: input}; // We pass input argument in Ajax
            $.ajax({
                type: "POST",
                url: ROOT_URL2 , // call the php file ajax/tuto-autocomplete.php (check the routine we defined)
                data: data, // Send dataFields var
                dataType: 'json', // json method
                timeout: 3000,
                success: function(response){ // If success
                    $('#acheteur').html(response.acheteur); // Return data (UL list) and insert it in the <div id="match"></div>
                    $('#matchList li').on('click', function() { // When click on an element in the list
                        $('#Graphes_contact').val($(this).attr('id')); // Update the field with the new element
                        $('#acheteur').text(''); // Clear the <div id="match"></div>

                    });
                    $('#indicator1').hide();

                },
                error: function() { // if error
                    $('#acheteur').text('Problem!');
                }
            });

        });

    </script>
{% endblock %}