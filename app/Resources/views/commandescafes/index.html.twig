{% extends 'baseAdmin.html.twig' %}

{% block body %}
    <script type="text/javascript" src="{{ asset('https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js') }}"></script>

    <div class="container-fluid">


        <div id="sidebar-nav" class="hidden-print at-scroll-content">

            <a class="btn-glow hidden-xs hidden-sm primary btn-block 1add_new 1add_new_invoice" title="Nouvelle facture" href="{{ path('admin_commandescafe_new') }}">Nouveau document</a>


            <div class="form" id="search_more_div" style="margin-top: 14px;">

                <strong style="font-size: 12px;display:block;margin-bottom:8px;padding-bottom:3px;border-bottom:1px solid #ddd">Rechercher</strong>


                {{ form_start(form) }}

                {{ form_label(form.mot, "Mot-clé ou n° ") }}
                {{ form_widget(form.mot,{'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.mot) }}

                {{ form_label(form.type, "Type de document ") }}
                {{ form_widget(form.type,{'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.type) }}
                <div id="periode">
                    {{ form_label(form.periode, "Période") }}
                    {{ form_widget(form.periode,{'attr': {'class': 'form-control periode'}}) }}
                    {{ form_errors(form.periode) }}
                </div>
                <div id="date">
                    {{ form_label(form.du, "Date du") }}
                    {{ form_widget(form.du,{'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.du) }}

                    {{ form_label(form.au, "Date au") }}
                    {{ form_widget(form.au,{'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.au) }}
                </div>
                {{ form_label(form.etat, "Etat") }}
                {{ form_widget(form.etat,{'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.etat) }}

                {{ form_label(form.zone, "Entrepôt") }}
                {{ form_widget(form.zone,{'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.zone) }}

                <input style="margin-top: 20px;" type="submit" value="Rechercher" title="Rechercher" class="btn-glow btn-block" onclick="$('#page').remove()">                        {{ form_end(form) }}




            </div> <!-- search_more_div -->






        </div>


        <main class="col-sm-9 ml-sm-auto col-md-10 pt-3 content" role="main">


            <section class="row text-center placeholders">
                <div class="row">
                    <div class="col-md-4"><h2 style="position: relative; float: left;">Revenus / Bon de Commande</h2>


                    </div>
                    <div style="padding-top: 20px;"></div>
                    <div class="btn-group pull-right">

                        <button data-toggle="dropdown" class="btn glow dropdown-toggle" style="margin-left:10px">
                            <i class="fa fa-cog"></i> <span class="caret"></span>
                        </button>


                        <ul class="dropdown-menu">
                            <li><a onclick="$('#dynamic_columns_modal').modal(); return false;" href="#">Personnaliser l'affichage des colonnes</a></li>
                        </ul>

                    </div>
                    <div class="btn-group pull-right" id="export_dropdown_menu">

                        <button data-toggle="dropdown" class="btn glow dropdown-toggle">
                            <i class="fa fa-download"></i> <span class="">Export</span> / <i class="icon-print"></i> <span class="">Imprimés</span> <span class="caret"></span>
                        </button>

                        <ul class="dropdown-menu">

                            <li role="presentation" class="dropdown-header" id="export_dropdown_menu_header">Tous les documents listés seront exportés</li>
                            <li role="presentation" class="divider"></li>
                            {% if type == null  %}
                                {% set type = 'tous' %}
                            {% endif %}
                            {% if etat == null  %}
                                {% set etat = 'tous' %}
                            {% endif %}
                            {% if periode == null  %}
                                {% set periode = 'tous' %}
                            {% endif %}
                            {% if mot == null  %}
                                {% set mot = 'tous' %}
                            {% endif %}
                            {% if zone == null  %}
                                {% set zone = 'tous' %}
                            {% endif %}

                            <li><a onclick="export_function('pdf');return false;" href="">Liste des documents (tableau) en format PDF</a></li>
                            <li><a  href="{{ path('admin_factures_allpdf',{ 'type':type,'periode':periode,'etat':etat,'zone':zone,'du':du|date("d-m-Y"),'au':au|date("d-m-Y"),'mot':mot}) }}">Documents dans un fichier PDF </a></li>



                        </ul>
                    </div>

                </div>
                <br>
                {% if commandescafes is not defined   %}
                    <div class="row">



                        <div id="list_table" class="narrower">





                            <style type="text/css" media="screen">
                                .content.scroll-content {
                                    width:auto !important;
                                    float: none;
                                }
                            </style>

                            <!-- blank state -->
                            <div class="blank-state">

                                <div class="center">

                                    <p style="    font-size: 13px;">Afin de créer un nouveau document, cliquez sur le bouton. </p>

                                    <a class="btn-glow btn-block btn-lg primary btn-block 1add_new 1add_new_invoice" title="Nouvelle facture" href="{{ path('admin_commandescafe_new') }}">Nouveau document</a>

                                </div>
                            </div>
                            <!-- end blank state -->


                            <p class="text-center">


                            </p>


                        </div> <!-- list_table -->

                        <script type="text/javascript">
                            var SUMMATIONS_CACHED_VARIABLES = {
                                initial_sums: {},
                                invoice_values: {},
                                price_keys: [],
                                original_total_count: 0
                            };
                        </script>




                        <script type="text/javascript">
                            $(function(){
                                //Firmlet.show_if_checked('#search_more_div', '#search_more');
                            });
                        </script>





                    </div>
                {% else %}
                    <div id="list_table" class="row">

                        <table id="example2" class="display" cellspacing="0"  style="">
                            <thead>
                            <tr>
                                <th>N°</th>
                                <th>DOCUMENTS DE GESTION DE STOCK</th>
                                <th>TOTAL HT</th>
                                <th>MONTANT TTC</th>
                                <th>CLIENT</th>
                                <th>DATE DE CRÉATION</th>
                                <th>PAIEMENT REÇU LE</th>
                                <th>PRODUIT</th>
                                <th>ETAT</th>
                                <th>FACTURÉ</th>
                                <th> </th>

                            </tr>
                            </thead>


                            <tbody>
                            {% set totalHT = 0 %}
                            {% set totalTTC = 0 %}
                            {% set facturesCount = 0 %}
                            {% set proformasCount = 0 %}
                            {% set recusCount = 0 %}
                            {% set devisCount = 0 %}
                            {% set commandescafeCount = 0 %}

                            {% for facture in factures %}
                                {% set facturesCount = facturesCount + 1 %}
                                <tr>
                                    <td>
                                        <a  style="text-decoration: none;" href="{{ path('admin_factures_show', { 'id': facture.id }) }}">
                            <span class="facture_mark" title="Facture">


                            {{ facture.nf }}

				            </span>
                                        </a>

                                        <a style="text-transform: none; padding-left: 5px;"href="{{ path('admin_factures_show', { 'id': facture.id }) }}">Facture</a></td>
                                    <td></td>
                                    <td>

                                        {% set sumHT = 0 %}

                                        {% set sumHT =  facture.totalHT %}
                                        {% set totalHT = totalHT + facture.totalHT  %}
                                        <a href="{{ path('admin_factures_show', { 'id': facture.id }) }}">{{ sumHT|number_format(2, ',', ' ')}} DA</a>

                                    </td>
                                    <td>
                                        {% set sumTTC = 0 %}
                                        {% set sumTTC = facture.totalTTC %}
                                        {% set totalTTC = totalTTC + facture.totalTTC  %}

                                        <a href="{{ path('admin_factures_show', { 'id': facture.id }) }}">{{ sumTTC|number_format(2, ',', ' ') }} DA</a>
                                        <input id="inputTTC{{ facture.id }}" type="hidden" value="{{ sumTTC  }}">
                                    </td>
                                    <td>
                                        {% if facture.acheteur.supp == 0 %}
                                            <a href="{{ path('admin_Acheteurs_show', { 'id': facture.acheteur.id }) }}">{{ facture.acheteur.nom }}</a>
                                        {% else %}
                                            <a title="{{ facture.acheteur.nom }}">{{ facture.acheteur.nom }}</a>


                                        {% endif %}
                                    </td>
                                    <td><a href="{{ path('admin_factures_show', { 'id': facture.id }) }}">{{ facture.datecreation|date("d/m/Y") }}</a></td>
                                    <td><a href="{{ path('admin_factures_show', { 'id': facture.id }) }}">{{ facture.datecreation|date("d/m/Y") }}</a></td>
                                    <td>
                                        {% for facture in facture.ventes %}
                                            {{ facture.name }},
                                        {% endfor %}
                                    </td>
                                    <td>

                                        <div class="btn-group" style="    height: 20px; ">

                                            {% if facture.etat == 'Créé' %}
                                                {% set retard = 0 %}
                                                {% set colorretard = 0 %}
                                                {% set limitedate = facture.datecreation|date("d") + facture.dateregle  %}
                                                {% if limitedate < "now"|date("d") %}
                                                    {% set retard =  "now"|date("d") - facture.datecreation|date("d")  %}
                                                    {% set colorretard = 'badge-retard' %}

                                                {% endif %}



                                                <span id="etat{{ facture.id }}" data-toggle="dropdown" class="colored_select badge status-issued {{ colorretard }}" style="background-position: -100px 0;" data-original-title="" title="">

                                                <i id="" style="" title="Envoyé le " class="icon-envelope-alt">&nbsp;</i>
                                                <span class="textetat{{ facture.id }}">{{ facture.etat }}</span>

                                                    {% if limitedate < "now"|date("d") %}

                                                        <div class="tooltip fade bottom in" id="info{{ facture.id }}" style="top: 19px; left: 14px; display: none; "><div class="tooltip-arrow"></div><div class="tooltip-inner">En retard: <br>{{ retard }} jours</div></div>

                                                    {% endif %}
                                                    <script>
                                                                     $('span#etat'+{{ facture.id }}).hover(

                                                                         function () {
                                                                             $('#info'+{{ facture.id }}).show();
                                                                         }, function () {
                                                                             $('#info'+{{ facture.id }}).hide();

                                                                         });
                                                        </script>
                                                        <span class="caret"></span>
                                            </span>

                                            {% elseif facture.etat =='Payé' %}
                                                {% set retard = 0 %}
                                                {% set colorretard = 0 %}
                                                {% set limitedate = facture.datecreation|date("d") + facture.dateregle  %}
                                                {% if limitedate < "now"|date("d") %}
                                                    {% set retard =  "now"|date("d") - facture.datecreation|date("d")  %}


                                                {% endif %}
                                                <span id="etat{{ facture.id }}"  data-toggle="dropdown" class="colored_select badge2 status-issued" style="background-position: -100px 0;" data-original-title="" title="">

                                    <i id="" style="" title="Envoyé le " class="icon-envelope-alt">&nbsp;</i>
                                    <span class="textetat{{ facture.id }}">{{ facture.etat }}</span>
                                                    {% if limitedate < "now"|date("d") %}

                                                        <div class="tooltip fade bottom in" id="info{{ facture.id }}" style="top: 19px; left: 14px; display: none; "><div class="tooltip-arrow"></div><div class="tooltip-inner">En retard: <br>{{ retard }} jours</div></div>

                                                    {% endif %}
                                                    <script>
                                                                     $('span#etat'+{{ facture.id }}).hover(

                                                                         function () {
                                                                             $('#info'+{{ facture.id }}).show();
                                                                         }, function () {
                                                                             $('#info'+{{ facture.id }}).hide();

                                                                         });
                                                        </script>
                                    <span class="caret"></span>
		                        	</span>
                                            {% elseif facture.etat =='Payé en partie' %}
                                                {% set pourcentage = facture.montantpaye*100/ sumTTC %}
                                                {% set retard = 0 %}
                                                {% set colorretard = 0 %}
                                                {% set limitedate = facture.datecreation|date("d") + facture.dateregle  %}
                                                {% if limitedate < "now"|date("d") %}
                                                    {% set retard =  "now"|date("d") - facture.datecreation|date("d")  %}


                                                {% endif %}
                                                <div class="progress prog{{ facture.id }}">
                                                    <div id="etat{{ facture.id }}" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40"
                                                         aria-valuemin="0" aria-valuemax="100" style="width:{{ pourcentage|round(1, 'floor')  }}%">
                                                    </div>

                                                </div>
                                                <span id="etat{{ facture.id }}" data-toggle="dropdown" class="colored_select badge status-issued progst" style="background: transparent; margin-top: -38px; border: none; box-shadow: none; color: white;     padding: 2px 8px;" data-original-title="" title="">

                                                <i id="" style="" title="Envoyé le " class="icon-envelope-alt">&nbsp;</i>
                                                <span class="">{{ facture.etat }}</span>
                                                    {% if limitedate < "now"|date("d") %}

                                                        <div class="tooltip fade bottom in" id="info{{ facture.id }}" style="top: 19px; left: 14px; display: none; "><div class="tooltip-arrow"></div><div class="tooltip-inner">En retard: <br>{{ retard }} jours</div></div>

                                                    {% endif %}
                                                    <script>
                                                                     $('span#etat'+{{ facture.id }}).hover(

                                                                         function () {
                                                                             $('#info'+{{ facture.id }}).show();
                                                                         }, function () {
                                                                             $('#info'+{{ facture.id }}).hide();

                                                                         });
                                                        </script>
                                                <span class="caret"></span>
                                            </span>

                                            {% endif %}

                                            <ul id="" class="dropdown-menu pull-right hidden-print" role="menu">

                                                <li>
                                                    <a class="facture_créé" id="{{ facture.id }}">Créé</a>

                                                </li>


                                                <li>
                                                    <a class="facture_payé" id="{{ facture.id }}">Payé</a>
                                                </li>
                                                <li>
                                                    <a href="#" class="partranche" id="{{ facture.id }}" type="{{ facture.type }}" data-toggle="modal" data-target="#exampleModal">Payé en partie</a>
                                                </li>

                                            </ul>
                                        </div>

                                    </td>
                                    <td></td>
                                    <td>
                                        <div class="btn-group pull-right">
                                            <button data-toggle="dropdown" class="btn glow dropdown-toggle">
                                                <i class="fa fa-cog"></i> <span class="caret"></span>
                                            </button>

                                            <ul class="dropdown-menu">
                                                <li><a title="Afficher" class="cms_show" href="{{ path('admin_factures_show', { 'id': facture.id }) }}">Afficher</a></li>


                                                <li><a class="cms_edit" href="{{ path('admin_factures_edit', { 'id': facture.id }) }}">Modifier</a></li>
                                                <li><a data-confirm="Êtes-vous sûr de vouloir effacer?" class="delete " data-remote="true" rel="nofollow" data-method="delete" href="{{ path('admin_factures_delete', { 'facture': facture.id }) }}">Effacer</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>

                            {% endfor %}

                            {% for commandescafe in commandescafes %}
                                {% set commandescafeCount = commandescafeCount + 1 %}
                                <tr>
                                    <td>{{ commandescafe.nf }} <a style="text-transform: none;"href="{{ path('admin_commandescafe_show', { 'id': commandescafe.id }) }}">Bon de Commande</a></td>
                                    <td></td>
                                    <td>
                                        {% set sumHT = 0 %}
                                        {% set sumHT =  commandescafe.totalHT %}
                                        {% set totalHT = totalHT + commandescafe.totalHT  %}

                                        <a href="{{ path('admin_commandescafe_show', { 'id': commandescafe.id }) }}">   {{ sumHT}} DA </a>
                                    </td>
                                    <td>
                                        {% set sumTTC = 0 %}
                                        {% set sumTTC = commandescafe.totalTTC %}
                                        {% set totalTTC = totalTTC + commandescafe.totalTTC  %}

                                        <a href="{{ path('admin_commandescafe_show', { 'id': commandescafe.id }) }}"> {{ sumTTC }} DA</a>
                                    </td>
                                    <td>
                                        {% if commandescafe.acheteur.supp == 0 %}
                                            <a href="{{ path('admin_Acheteurs_show', { 'id': commandescafe.acheteur.id }) }}">{{ commandescafe.acheteur.nom }}</a>
                                        {% else %}
                                            <a title="{{ commandescafe.acheteur.nom }}">{{ commandescafe.acheteur.nom }}</a>


                                        {% endif %}

                                    </td>                                        <td> <a href="{{ path('admin_commandescafe_show', { 'id': commandescafe.id }) }}">{{ commandescafe.datecreation|date("d/m/Y") }}</a></td>
                                    <td> <a href="{{ path('admin_commandescafe_show', { 'id': commandescafe.id }) }}">{{ commandescafe.datecreation|date("d/m/Y") }}</a></td>
                                    <td>
                                        {% for commandescafe in commandescafe.ventes %}
                                            {{ commandescafe.name }},
                                        {% endfor %}
                                    </td>
                                    <td>
                                        <div class="btn-group" style="    height: 20px; ">
                                            {% if commandescafe.etat == 'Créé' %}
                                                {% set retard = 0 %}
                                                {% set colorretard = 0 %}

                                                {% set limitedate = commandescafe.datecreation|date("d") + commandescafe.dateregle  %}
                                                {% if limitedate < "now"|date("d") %}
                                                    {% set retard =  "now"|date("d") - commandescafe.datecreation|date("d")  %}


                                                {% endif %}


                                                <span id="etat_commandescafe{{ commandescafe.id }}" data-toggle="dropdown" class="colored_select badge status-issued {{ colorretard }}" style="background-position: -100px 0;" data-original-title="" title="">

                                                <i id="" style="" title="Envoyé le " class="icon-envelope-alt">&nbsp;</i>
                                                <span class="textetat{{ commandescafe.id }}">{{ commandescafe.etat }}</span>

                                                    {% if limitedate < "now"|date("d") %}

                                                        <div class="tooltip fade bottom in" id="info{{ commandescafe.id }}" style="top: 19px; left: 14px; display: none; "><div class="tooltip-arrow"></div><div class="tooltip-inner">En retard: <br>{{ retard }} jours</div></div>

                                                    {% endif %}
                                                    <script>
                                                                     $('span#etat_commandescafe'+{{ commandescafe.id }}).hover(

                                                                         function () {
                                                                             $('#info'+{{ commandescafe.id }}).show();
                                                                         }, function () {
                                                                             $('#info'+{{ commandescafe.id }}).hide();

                                                                         });
                                                        </script>
                                                        <span class="caret"></span>
                                            </span>

                                            {% elseif commandescafe.etat =='Payé' %}
                                                {% set retard = 0 %}
                                                {% set colorretard = 0 %}
                                                {% set limitedate = commandescafe.datecreation|date("d") + commandescafe.dateregle  %}
                                                {% if limitedate < "now"|date("d") %}
                                                    {% set retard =  "now"|date("d") - commandescafe.datecreation|date("d")  %}


                                                {% endif %}
                                                <span id="etat_commandescafe{{ commandescafe.id }}"  data-toggle="dropdown" class="colored_select badge2 status-issued" style="background-position: -100px 0;" data-original-title="" title="">

                                    <i id="" style="" title="Envoyé le " class="icon-envelope-alt">&nbsp;</i>
                                    <span class="textetat{{ commandescafe.id }}">{{ commandescafe.etat }}</span>
                                                    {% if limitedate < "now"|date("d") %}

                                                        <div class="tooltip fade bottom in" id="info{{ commandescafe.id }}" style="top: 19px; left: 14px; display: none; "><div class="tooltip-arrow"></div><div class="tooltip-inner">En retard: <br>{{ retard }} jours</div></div>

                                                    {% endif %}
                                                    <script>
                                                                     $('span#etat_commandescafe'+{{ commandescafe.id }}).hover(

                                                                         function () {
                                                                             $('#info'+{{ commandescafe.id }}).show();
                                                                         }, function () {
                                                                             $('#info'+{{ commandescafe.id }}).hide();

                                                                         });
                                                        </script>
                                    <span class="caret"></span>
		                        	</span>
                                            {% elseif commandescafe.etat =='Payé en partie' %}
                                                {% set pourcentage = commandescafe.montantpaye*100/ sumTTC %}
                                                {% set retard = 0 %}
                                                {% set colorretard = 0 %}
                                                {% set limitedate = commandescafe.datecreation|date("d") + commandescafe.dateregle  %}
                                                {% if limitedate < "now"|date("d") %}
                                                    {% set retard =  "now"|date("d") - commandescafe.datecreation|date("d")  %}


                                                {% endif %}
                                                <div class="progress prog{{ commandescafe.id }}">
                                                    <div id="etat_commandescafe{{ commandescafe.id }}" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40"
                                                         aria-valuemin="0" aria-valuemax="100" style="width:{{ pourcentage|round(1, 'floor')  }}%">
                                                    </div>

                                                </div>
                                                <span id="etat_commandescafe{{ commandescafe.id }}" data-toggle="dropdown" class="colored_select badge status-issued progst" style="background: transparent; margin-top: -38px; border: none; box-shadow: none; color: white;     padding: 2px 8px;" data-original-title="" title="">

                                                <i id="" style="" title="Envoyé le " class="icon-envelope-alt">&nbsp;</i>
                                                <span class="">{{ commandescafe.etat }}</span>
                                                    {% if limitedate < "now"|date("d") %}

                                                        <div class="tooltip fade bottom in" id="info{{ commandescafe.id }}" style="top: 19px; left: 14px; display: none; "><div class="tooltip-arrow"></div><div class="tooltip-inner">En retard: <br>{{ retard }} jours</div></div>

                                                    {% endif %}
                                                    <script>
                                                                     $('span#etat_commandescafe'+{{ commandescafe.id }}).hover(

                                                                         function () {
                                                                             $('#info'+{{ commandescafe.id }}).show();
                                                                         }, function () {
                                                                             $('#info'+{{ commandescafe.id }}).hide();

                                                                         });
                                                        </script>
                                                <span class="caret"></span>
                                            </span>

                                            {% endif %}

                                            <ul id="" class="dropdown-menu pull-right hidden-print" role="menu">

                                                <li>
                                                    <a class="commandescafe_créé" id="{{ commandescafe.id }}">Créé</a>
                                                </li>


                                                <li>
                                                    <a class="commandescafe_payé" id="{{ commandescafe.id }}">Payé</a>
                                                </li>
                                                <li>
                                                    <a href="#" class="partranche_commandescafe" id="{{ commandescafe.id }}" type="{{ commandescafe.type }}" data-toggle="modal" data-target="#exampleModal">Payé en partie</a>
                                                </li>

                                            </ul>
                                        </div>
                                    </td>
                                    <td></td>
                                    <td>
                                        <div class="btn-group pull-right">
                                            <button data-toggle="dropdown" class="btn glow dropdown-toggle">
                                                <i class="fa fa-cog"></i> <span class="caret"></span>
                                            </button>

                                            <ul class="dropdown-menu">
                                                <li><a title="Afficher" class="cms_show" href="{{ path('admin_commandescafe_show', { 'id': commandescafe.id }) }}">Afficher</a></li>


                                                <li><a class="cms_edit" href="{{ path('admin_commandescafe_edit', { 'id': commandescafe.id }) }}">Modifier</a></li>
                                                <li><a data-confirm="Êtes-vous sûr de vouloir effacer?" class="delete " data-remote="true" rel="nofollow" data-method="delete" href="{{ path('admin_commandescafe_delete', { 'id': commandescafe.id }) }}">Effacer</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>

                            {% endfor %}
                            <tr>
                                <td></td>


                                <td id="total_count">
                                    {% set totalCount = facturesCount + proformasCount + recusCount + devisCount + commandescafeCount %}
                                    <span class="text-muted ">Total:  {{ totalCount }}</span>
                                </td>

                                <td id="total_price_net" style="width: 100px;">
                                    <strong id="total_price_net_values">{{ totalHT|number_format(2, ',', ' ') }} DA<br></strong>

                                    <strong id="total_price_net_sum"></strong>
                                </td>

                                <td id="total_price_gross" style="width: 100px;" class="digit">
                                    <strong id="total_price_gross_values">{{ totalTTC|number_format(2, ',', ' ') }} DA<br></strong>

                                    <strong id="total_price_gross_sum"></strong>
                                </td>

                                <td id="total_price_gross" style="" class="digit">

                                </td>

                                <td></td>

                                <td></td>

                                <td></td>

                                <td></td>

                                <td></td>

                                <td></td>



                            </tr>
                            </tbody>
                        </table>

                    </div>
                {% endif %}


                <!-- Modal -->
                <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        {{ form_start(form2) }}
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title" style="color: #29323d;font-size: 18px; float: left;">Montant payé</h4>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">

                                {{ form_label(form2.type, " ") }}
                                {{ form_widget(form2.type,{'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form2.type) }}


                                {{ form_label(form2.id, " ") }}
                                {{ form_widget(form2.id,{'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form2.id) }}

                                {{ form_label(form2.prix, " ") }}
                                {{ form_widget(form2.prix,{'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form2.prix) }}


                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                                <button type="submit" class="btn btn-primary">Sauvegarder</button>
                            </div>
                        </div>
                        {{ form_end(form2) }}
                    </div>
                </div>
            </section>



        </main>
    </div>


    <script>
        $('#date').hide();

        $("#periode").change(function() {

            if ($('#option_searchs_periode').val() == 'more') {
                $('#periode').hide();
                $('#date').show();


            }
        });
        $('.facture_créé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_factures_etat',{id:$(this).attr('id'), etat:'Créé', ttc:0}),
                success: function (data) {
                    $('#etat'+data.id).removeClass().addClass( "colored_select badge status-issued" );
                    $('.textetat'+data.id).text('Créé');
                    $('.prog'+data.id).remove();
                    $('#etat'+data.id).removeAttr( 'style' );
                    $('#etat'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat'+data.id).html('Créé <span class="caret"> </span>');


                }
            });


        });
        $('.facture_payé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_factures_etat',{id:$(this).attr('id'), etat:'Payé', ttc:$('#inputTTC'+$(this).attr('id')).val()}),
                success: function (data) {

                    $('#etat'+data.id).removeClass().addClass( "colored_select badge2 status-issued" );
                    $('.textetat'+data.id).text('Payé');
                    $('.prog'+data.id).remove();
                    $('#etat'+data.id).removeAttr( 'style' );
                    $('#etat'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat'+data.id).removeClass().addClass( "progst colored_select badge2 status-issued" );
                    $('#etat'+data.id).html('Payé <span class="caret"> </span>');


                }
            });


        });



        $('.proforma_créé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_proformas_etat',{id:$(this).attr('id'), etat:'Créé', ttc:0}),
                success: function (data) {
                    $('#etat_proforma'+data.id).removeClass().addClass( "colored_select badge status-issued" );
                    $('.textetat_proforma'+data.id).text('Créé');
                    $('.prog_proforma'+data.id).remove();
                    $('#etat_proforma'+data.id).removeAttr( 'style' );
                    $('#etat_proforma'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat_proforma'+data.id).html('Créé <span class="caret"> </span>');
                }
            });


        });
        $('.proforma_payé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_proformas_etat',{id:$(this).attr('id'), etat:'Payé', ttc:$('#inputTTC'+$(this).attr('id')).val()}),
                success: function (data) {

                    $('#etat_proforma'+data.id).removeClass().addClass( "colored_select badge2 status-issued" );
                    $('.textetat_proforma'+data.id).text('Payé');
                    $('.prog_proforma'+data.id).remove();
                    $('#etat_proforma'+data.id).removeAttr( 'style' );
                    $('#etat_proforma'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat_proforma'+data.id).removeClass().addClass( "progst_proforma colored_select badge2 status-issued" );
                    $('#etat_proforma'+data.id).html('Payé <span class="caret"> </span>');


                }
            });


        });

        $('.devis_créé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_devis_etat',{id:$(this).attr('id'), etat:'Créé', ttc:0}),
                success: function (data) {
                    $('#etat_devis'+data.id).removeClass().addClass( "colored_select badge status-issued" );
                    $('.textetat_devis'+data.id).text('Créé');
                    $('.prog_devis'+data.id).remove();
                    $('#etat_devis'+data.id).removeAttr( 'style' );
                    $('#etat_devis'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat_devis'+data.id).html('Créé <span class="caret"> </span>');
                }
            });


        });
        $('.devis_payé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_devis_etat',{id:$(this).attr('id'), etat:'Payé', ttc:$('#inputTTC'+$(this).attr('id')).val()}),
                success: function (data) {

                    $('#etat_devis'+data.id).removeClass().addClass( "colored_select badge2 status-issued" );
                    $('.textetat_devis'+data.id).text('Payé');
                    $('.prog_devis'+data.id).remove();
                    $('#etat_devis'+data.id).removeAttr( 'style' );
                    $('#etat_devis'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat_devis'+data.id).removeClass().addClass( "progst_devis colored_select badge2 status-issued" );
                    $('#etat_devis'+data.id).html('Payé <span class="caret"> </span>');


                }
            });


        });

        $('.recu_créé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_recus_etat',{id:$(this).attr('id'), etat:'Créé', ttc:0}),
                success: function (data) {
                    $('#etat_recu'+data.id).removeClass().addClass( "colored_select badge status-issued" );
                    $('.textetat_recu'+data.id).text('Créé');
                    $('.prog_recu'+data.id).remove();
                    $('#etat_recu'+data.id).removeAttr( 'style' );
                    $('#etat_recu'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat_recu'+data.id).html('Créé <span class="caret"> </span>');
                }
            });


        });
        $('.recu_payé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_recus_etat',{id:$(this).attr('id'), etat:'Payé', ttc:$('#inputTTC'+$(this).attr('id')).val()}),
                success: function (data) {

                    $('#etat_recu'+data.id).removeClass().addClass( "colored_select badge2 status-issued" );
                    $('.textetat_recu'+data.id).text('Payé');
                    $('.prog_recu'+data.id).remove();
                    $('#etat_recu'+data.id).removeAttr( 'style' );
                    $('#etat_recu'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat_recu'+data.id).removeClass().addClass( "progst_recu colored_select badge2 status-issued" );
                    $('#etat_recu'+data.id).html('Payé <span class="caret"> </span>');


                }
            });


        });



        $('.commandescafe_créé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_bonscommandes_etat',{id:$(this).attr('id'), etat:'Créé', ttc:0}),
                success: function (data) {
                    $('#etat_commandescafe'+data.id).removeClass().addClass( "colored_select badge status-issued" );
                    $('.textetat_commandescafe'+data.id).text('Créé');
                    $('.prog_commandescafe'+data.id).remove();
                    $('#etat_commandescafe'+data.id).removeAttr( 'style' );
                    $('#etat_commandescafe'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat_commandescafe'+data.id).html('Créé <span class="caret"> </span>');
                }
            });


        });
        $('.commandescafe_payé').click(function(){
            $.ajax({
                type:'GET',
                url: Routing.generate('admin_bonscommandes_etat',{id:$(this).attr('id'), etat:'Payé', ttc:$('#inputTTC'+$(this).attr('id')).val()}),
                success: function (data) {

                    $('#etat_commandescafe'+data.id).removeClass().addClass( "colored_select badge2 status-issued" );
                    $('.textetat_commandescafe'+data.id).text('Payé');
                    $('.prog_commandescafe'+data.id).remove();
                    $('#etat_commandescafe'+data.id).removeAttr( 'style' );
                    $('#etat_commandescafe'+data.id).css( 'background-position: -100px 0;' );
                    $('#etat_commandescafe'+data.id).removeClass().addClass( "progst_commandescafe colored_select badge2 status-issued" );
                    $('#etat_commandescafe'+data.id).html('Payé <span class="caret"> </span>');


                }
            });


        });


        $('.partranche').click(function(){

            $('#partranche_id').val($(this).attr('id'))

            $('#partranche_type').val($(this).attr('type'))

        });

        $('.partranche_proforma').click(function(){

            $('#partranche_id').val($(this).attr('id'))

            $('#partranche_type').val($(this).attr('type'))

        });

        $('.partranche_recu').click(function(){

            $('#partranche_id').val($(this).attr('id'))

            $('#partranche_type').val($(this).attr('type'))

        });
        $('.partranche_devis').click(function(){

            $('#partranche_id').val($(this).attr('id'))

            $('#partranche_type').val($(this).attr('type'))

        });
        $('.partranche_commandescafe').click(function(){

            $('#partranche_id').val($(this).attr('id'))

            $('#partranche_type').val($(this).attr('type'))

        });
        $(document).ready(function(){



            $(".delete").click(function(){
                if (!confirm("Êtes-vous sûr de vouloir effacer ce document?")){
                    return false;
                }
            });


            $("#filtre_commandescafe_zone").change(function() {

                $( "#filtre_commandescafe_valzone" ).val($( "#filtre_commandescafe_zone" ).val());
                if(!$('#filtre_commandescafe_zone').val() ){
                    $( "#filtre_commandescafe_valzone" ).val('tous');
                }

            });
            $( "#filtre_commandescafe_valzone" ).val('tous');

        });

    </script>

{% endblock %}
